{% extends 'base.html' %}
{% load static %}
{% block title %}Clientes{% endblock %}

{% block content %}
<nav class="mb-3">
    <a href="{% url 'home' %}">Início</a> |
    <a href="{% url 'lista_clientes' %}">Clientes</a> |
    <a href="{% url 'plano_list' %}">Planos</a> |
    <a href="{% url 'pagamento_list' %}">Pagamentos</a> |
    <a href="{% url 'logout' %}">Sair</a>
</nav>

<div class="card shadow">
    <div class="card-header d-flex justify-content-between align-items-center bg-primary text-white">
        <h2 class="mb-0">
            <i class="bi bi-people-fill"></i> Clientes
        </h2>
        <a href="{% url 'criar_cliente' %}" class="btn btn-light btn-sm fw-bold">
            <i class="bi bi-plus-circle"></i> Novo Cliente
        </a>
    </div>

    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th style="width:80px">Foto</th>
                        <th>Nome</th>
                        <th>Identidade</th>
                        <th>Plano</th>
                        <th>Vencimento</th>
                        <th style="width:100px">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cliente in clientes %}
                    <tr>
                        <td>
                            {% if cliente.imagem %}
                                <div class="rounded-circle border border-2 border-primary" style="width:60px;height:60px;overflow:hidden;display:inline-block;">
                                    <img src="{{ cliente.imagem.url }}" alt="Foto {{ cliente.nome }}" 
                                         style="width:100%;height:100%;object-fit:cover;display:block;">
                                </div>
                            {% else %}
                                <div class="rounded-circle border border-2 border-secondary bg-light d-flex align-items-center justify-content-center" style="width:60px;height:60px;">
                                    <i class="bi bi-person-fill text-muted" style="font-size:1.5rem;"></i>
                                </div>
                            {% endif %}
                        </td>

                        <td>
                            <strong class="text-dark">{{ cliente.nome }}</strong>
                        </td>
                        <td>
                            <small class="text-muted">{{ cliente.identidade }}</small>
                        </td>
                        <td>
                            {% if cliente.plano != "-" %}
                                <span class="badge bg-success">{{ cliente.plano }}</span>
                            {% else %}
                                <span class="badge bg-secondary">Sem plano</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="{{ cliente.status_class }}" aria-label="Status: {{ cliente.status_vencimento }}">{{ cliente.status_vencimento }}</span>
                        </td>
                        <td>
                            <a href="{% url 'cliente_detail' cliente.pk %}"
                               class="btn btn-sm btn-info text-white fw-bold">
                                <i class="bi bi-eye"></i> Detalhes
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="text-center text-muted py-5">
                            <i class="bi bi-inbox" style="font-size:2rem;"></i>
                            <p class="mt-2">Nenhum cliente cadastrado.</p>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
